# 原神千星奇域·综合指南 - 网站爬取项目

## 项目介绍

本项目旨在爬取原神千星奇域·综合指南网站的所有文档页面，转换为Markdown格式便于阅读和管理。通过自动化的方式，将官方文档完整地保存到本地，支持离线查阅和后续处理。

## 目标网站

- **网站地址**：https://act.mihoyo.com/ys/ugc/tutorial/detail/mh29wpicgvh0
- **内容类型**：游戏创作工具的综合指南文档
- **页面数量**：167个文档页面

## 目录结构

```
.
├── src/                 # 源代码目录
│   ├── main.py          # 主程序入口
│   ├── crawler/         # 爬虫核心模块
│   │   ├── spider.py    # 网页爬取器
│   │   ├── parser.py    # 内容解析器
│   │   └── downloader.py # 资源下载器
│   └── __init__.py      # 包初始化文件
├── config/              # 配置文件目录
│   └── logging_config.py # 日志配置
├── data/                # 数据存储目录
│   ├── markdown/        # 爬取的Markdown文档
│   └── images/          # 下载的图片资源
├── logs/                # 日志文件目录
├── requirements.txt     # 第三方依赖列表
├── README.md            # 项目说明文档
├── CHANGELOG.md         # 变更记录
└── .gitignore           # Git忽略文件
```

## 功能特性

- ✅ 自动爬取所有文档页面
- ✅ 将HTML转换为Markdown格式
- ✅ 本地化所有链接和图片资源
- ✅ 支持断点续爬
- ✅ 支持极长内容分段处理
- ✅ 完善的日志记录系统
- ✅ 质量控制机制
- ✅ 支持异步并行爬取

## 安装依赖

### 环境要求

- Python 3.8+
- pip 20.0+

### 安装步骤

1. 克隆项目仓库
2. 安装依赖包

```bash
pip install -r requirements.txt
```

## 使用方法

### 基本使用

1. 确保配置文件正确设置
2. 运行主程序

```bash
python src/main.py
```

### 配置说明

- 日志配置：`config/logging_config.py`
- 爬取参数：在代码中直接配置

## 爬取策略

- 按导航结构顺序爬取
- 采用异步并行爬取，最大并发数为3
- 每个请求间隔1-2秒
- 支持断点续爬
- 自动重试失败的请求（最大重试次数：3）

## 质量控制

- 自动检查内容完整性
- 验证链接有效性
- 确保格式一致性
- 支持人工审议
- 生成爬取进度报告

## 开发流程

### 代码规范

- 遵循PEP 8规范
- 使用4空格缩进
- 变量/函数使用snake_case命名
- 类使用PascalCase命名
- 行宽≤120字符

### 提交规范

- 提交信息清晰明了
- 遵循"类型: 描述"的格式
- 类型包括：feat, fix, docs, style, refactor, test, chore

### 测试

- 使用pytest框架
- 测试文件以test_开头
- 测试覆盖率≥80%

## 项目状态

### 当前进度

- ✅ 爬虫核心功能实现
- ✅ HTML转Markdown功能
- ✅ 图片资源本地化
- ✅ 链接本地化
- ✅ 日志系统
- ✅ 进度报告生成
- ⏳ 完整爬取167个文档页面

### 已实现功能

- 单页面爬取测试通过
- 批量爬取功能实现
- 进度报告生成
- 日志记录系统

### 存在问题

- 部分页面解析不完全
- 图片链接匹配问题
- 长文档分段处理优化

## 后续计划

1. 完成167个文档页面的完整爬取
2. 优化页面解析算法
3. 完善质量控制机制
4. 添加单元测试
5. 实现持续集成/持续部署
6. 开发Web管理界面

## 文档资料

详细的文档资料存放于`.trae/documents/`目录，包括：

- 网站爬取执行计划
- 网站导航结构报告
- 页面分析报告
- 项目进度管理计划
- 成果物自检规范
- 成果物收集表
- 人工审议意见表
- 代码审查指南
- 提交规范
- 版本控制规范

## 许可证

MIT License
