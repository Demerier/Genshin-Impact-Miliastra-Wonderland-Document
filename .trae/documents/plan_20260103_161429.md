# 项目文件结构优化方案

## 1. 问题分析

### 1.1 测试目录分散
- `src/tests/` 包含 `test_crawler.py`
- 根目录 `tests/` 包含 `test_parser.py`
- 测试文件分散，不便于管理和运行

### 1.2 调试文件位置不当
- 根目录有 `debug_page.py`，但已有 `debug/` 目录
- 调试文件未统一管理

### 1.3 脚本文件分散
- `src/` 目录下有多个独立脚本，缺乏分类
- 可维护性差，不易扩展

### 1.4 数据与报告混合
- `data/` 目录下包含报告文件（如 `long_content_report.md`）
- 数据与报告未分离，不符合单一职责原则

### 1.5 配置文件缺失
- 虽然提到 `config/` 目录，但实际结构中配置文件不足
- 配置未集中管理

### 1.6 文档分类不清晰
- 所有文档直接存放在 `docs/` 目录下
- 缺乏清晰的分类结构

## 2. 优化方案

### 2.1 优化原则
- **单一职责**：每个目录/文件只负责一个功能
- **清晰分类**：按功能和用途分类存放
- **便于维护**：结构清晰，易于理解和扩展
- **符合规范**：遵循Python项目最佳实践

### 2.2 优化后的目录结构

```
markdown/
├── config/              # 配置文件目录
│   ├── __init__.py      # 配置模块初始化
│   ├── crawl_config.json # 爬取配置
│   └── logging_config.py # 日志配置
├── data/                # 数据存储目录
│   ├── raw/             # 原始数据
│   │   └── url_list.txt # 爬取URL列表
│   ├── processed/       # 处理后的数据
│   │   └── long_content_files.txt # 长内容文件列表
│   ├── markdown/        # 爬取的Markdown文档
│   └── images/          # 下载的图片资源
├── debug/               # 调试文件目录
│   ├── full_page.html   # 调试用的完整页面HTML
│   └── debug_page.py    # 调试页面脚本
├── docs/                # 文档资料目录
│   ├── guidelines/      # 规范文档
│   │   ├── CODE_REVIEW_GUIDELINES.md
│   │   ├── COMMIT_GUIDELINES.md
│   │   ├── DOCUMENT_CHANGE_NOTIFICATION.md
│   │   ├── DOCUMENTATION_INDEX.md
│   │   └── VERSIONING_GUIDELINES.md
│   ├── plans/           # 计划文档
│   │   ├── 后续工作计划.md
│   │   ├── 网站爬取执行计划.md
│   │   └── 项目进度管理计划.md
│   ├── reports/         # 报告文档
│   │   ├── 长内容报告.md
│   │   ├── 项目总结报告.md
│   │   ├── TEST_REPORT.md
│   │   ├── 网站导航结构报告.md
│   │   ├── 页面分析报告.md
│   │   └── 爬取进度报告.md
│   └── forms/           # 表单文档
│       ├── 人工审议意见表.md
│       ├── 成果物收集表.md
│       └── 成果物自检规范.md
├── logs/                # 日志文件目录
├── scripts/             # 辅助脚本目录
│   ├── ai_full_inspection.py
│   ├── check_crawl_results.py
│   ├── fix_format_issues.py
│   ├── identify_long_content.py
│   ├── initial_data_collection.py
│   └── test_crawl.py
├── src/                 # 源代码目录
│   ├── __init__.py      # 项目包初始化
│   ├── main.py          # 主程序入口
│   ├── crawler/         # 爬虫核心模块
│   │   ├── __init__.py
│   │   ├── spider.py    # 爬虫模块
│   │   ├── parser.py    # 解析器模块
│   │   └── downloader.py # 下载器模块
│   ├── utils/           # 工具函数
│   │   └── __init__.py
│   └── services/        # 业务服务模块（新增）
│       └── __init__.py
├── tests/               # 测试目录（统一管理）
│   ├── __init__.py
│   ├── test_crawler.py
│   ├── test_parser.py
│   └── test_downloader.py
├── .gitignore           # Git忽略文件
├── CHANGELOG.md         # 项目变更日志
├── README.md            # 项目说明文档
├── requirements.txt     # 第三方依赖列表
└── WORKSPACE_STRUCTURE.md # 工作区结构说明文档
```

## 3. 优化措施

### 3.1 统一测试目录
- 删除 `src/tests/` 目录
- 将所有测试文件移到根目录 `tests/` 下
- 按模块组织测试文件

### 3.2 集中调试文件
- 将根目录的 `debug_page.py` 移到 `debug/` 目录
- 调试文件统一管理

### 3.3 脚本分类存放
- 创建 `scripts/` 目录，存放所有辅助脚本
- 脚本按功能分类，提高可维护性

### 3.4 数据与报告分离
- 将 `data/` 中的报告文件移到 `docs/reports/`
- `data/` 目录只存放原始数据和爬取结果
- 新增 `data/raw/` 和 `data/processed/` 目录，区分数据阶段

### 3.5 完善配置管理
- 创建 `config/` 目录，集中管理配置文件
- 新增 `crawl_config.json` 和 `logging_config.py`
- 配置文件与代码分离，便于维护

### 3.6 文档分类管理
- 将文档按类型分类到 `docs/guidelines/`、`docs/plans/`、`docs/reports/`、`docs/forms/`
- 提高文档的可查找性和可维护性

### 3.7 新增业务服务层
- 新增 `src/services/` 目录，处理业务逻辑
- 实现核心功能与业务逻辑分离

## 4. 流程优化

### 4.1 开发流程
1. 从 `main` 分支创建功能分支
2. 实现功能，编写测试
3. 运行所有测试，确保通过
4. 创建Pull Request，请求合并到 `main` 分支
5. 代码审查通过后，合并到 `main` 分支
6. 发布新版本时，创建标签

### 4.2 爬取流程
1. 运行 `scripts/initial_data_collection.py` 收集URL列表
2. 运行 `src/main.py` 执行爬取
3. 运行 `scripts/check_crawl_results.py` 检查爬取结果
4. 运行 `scripts/ai_full_inspection.py` 进行质量检查
5. 如有需要，运行 `scripts/fix_format_issues.py` 修复格式问题

### 4.3 测试流程
- 使用 `pytest tests/` 运行所有测试
- 测试覆盖核心功能，确保代码质量

## 5. 预期效果

### 5.1 提高可维护性
- 目录结构清晰，便于理解和扩展
- 按功能分类，减少查找时间
- 测试文件集中管理，便于运行和维护

### 5.2 提高可扩展性
- 模块化设计，便于添加新功能
- 配置集中管理，便于调整参数
- 脚本分类存放，便于添加新脚本

### 5.3 符合最佳实践
- 遵循Python项目结构最佳实践
- 便于团队协作和新成员快速上手
- 提高代码质量和项目可靠性

## 6. 实施步骤

1. 创建新目录结构
2. 迁移文件到新位置
3. 更新导入路径
4. 测试功能完整性
5. 更新文档
6. 通知团队成员