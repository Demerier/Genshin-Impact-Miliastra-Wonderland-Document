# 代码审查指南

## 1. 概述

代码审查是保证代码质量、减少bug、提高团队代码一致性的重要手段。本指南定义了本项目的代码审查流程、标准和最佳实践。

## 2. 代码审查流程

### 2.1 分支管理

- 所有功能开发必须在独立的feature分支上进行
- 分支命名格式：`feature/功能描述`，例如：`feature/user-authentication`
- 分支必须从`develop`分支创建

### 2.2 Pull Request 创建

1. 功能开发完成后，从feature分支向develop分支创建Pull Request
2. 填写Pull Request模板，包括：
   - 功能描述
   - 实现细节
   - 测试情况
   - 相关issue
3. 至少指定1名审查者

### 2.3 代码审查

1. 审查者收到通知后，应在24小时内开始审查
2. 审查内容包括：
   - 代码质量（可读性、可维护性、性能）
   - 功能完整性
   - 测试覆盖
   - 代码风格
   - 安全性
3. 使用评论功能提供反馈
4. 对于需要修改的内容，标记为"需要修改"
5. 对于通过审查的内容，标记为"通过"

### 2.4 代码修改

1. 作者根据审查反馈进行修改
2. 修改完成后，重新提交并通知审查者
3. 审查者重新审查修改内容

### 2.5 分支合并

1. 所有审查通过后，由审查者或作者合并分支
2. 合并后删除feature分支
3. 合并信息应包含Pull Request编号

## 3. 代码审查标准

### 3.1 代码质量

- **可读性**：代码应易于理解，变量名、函数名应清晰明了
- **可维护性**：代码应模块化，避免重复代码，遵循单一职责原则
- **性能**：避免不必要的计算和I/O操作，优化算法复杂度
- **安全性**：避免SQL注入、XSS攻击等安全漏洞

### 3.2 功能完整性

- 代码应实现所有需求功能
- 边界情况处理完善
- 错误处理机制健全

### 3.3 测试覆盖

- 新增功能必须包含单元测试
- 测试覆盖率应不低于80%
- 测试用例应覆盖正常情况和异常情况

### 3.4 代码风格

- 遵循项目的代码风格指南
- 统一的缩进、换行和命名规范
- 适当的注释（解释"为什么"，而不是"如何"）

## 4. 代码审查最佳实践

### 4.1 审查者

- 保持客观，关注代码而非个人
- 提供具体的反馈，避免模糊的评论
- 优先关注重要问题（功能、性能、安全），其次是风格问题
- 认可好的代码，鼓励作者

### 4.2 作者

- 保持开放心态，接受反馈
- 解释复杂的实现逻辑
- 及时回复评论，说明修改计划
- 感谢审查者的时间和努力

## 5. 代码审查工具

- **GitHub/GitLab**：Pull Request功能
- **SonarQube**：代码质量分析
- **ESLint/Flake8**：代码风格检查
- **Codecov**：测试覆盖率分析

## 6. 特殊情况处理

### 6.1 紧急修复

- 对于紧急bug修复，可以适当简化审查流程
- 但仍需至少1名审查者确认
- 修复后应尽快补充完整的测试用例

### 6.2 大型PR

- 对于超过500行的大型PR，建议拆分为多个小型PR
- 或提前与审查者沟通，安排专门的审查时间

## 7. 代码审查模板

```markdown
# Pull Request 标题

## 功能描述

简要描述本次PR实现的功能或修复的bug

## 实现细节

详细描述实现方案、关键算法和技术选型

## 测试情况

- [ ] 单元测试通过
- [ ] 集成测试通过
- [ ] 手动测试通过

## 相关issue

- Closes #123
- Relates to #456

## 审查要点

请审查者重点关注的部分

## 其他说明

其他需要说明的内容
```

## 8. 代码审查检查清单

### 8.1 代码结构
- [ ] 代码组织合理，模块化清晰
- [ ] 遵循单一职责原则
- [ ] 避免重复代码

### 8.2 代码质量
- [ ] 变量名、函数名清晰明了
- [ ] 注释适当，解释"为什么"而非"如何"
- [ ] 错误处理完善
- [ ] 性能优化合理

### 8.3 功能实现
- [ ] 实现了所有需求功能
- [ ] 边界情况处理完善
- [ ] 与现有代码兼容

### 8.4 测试
- [ ] 新增功能有单元测试
- [ ] 测试覆盖率达标
- [ ] 测试用例覆盖正常和异常情况

### 8.5 安全性
- [ ] 避免SQL注入
- [ ] 避免XSS攻击
- [ ] 敏感数据处理安全
- [ ] 权限控制完善

## 9. 定期回顾

团队应定期回顾代码审查流程，总结经验教训，持续优化审查效率和质量。
